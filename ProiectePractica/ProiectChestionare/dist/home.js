(()=>{"use strict";var e={370(e,t,n){n.d(t,{s:()=>a});var s=n(611);const o="http://127.0.0.1:8000";class a{_username;_password;constructor(e,t){this._username=e,this._password=t,Object.seal(this),Object.preventExtensions(this)}get username(){return this._username}get password(){return this._password}}window.onload=async function(){document.getElementById("login_button").addEventListener("click",function(){!async function(e,t){const n=await async function(e,t){try{const n=document.getElementById(e),o=document.getElementById(t);if(null===n||null===o)throw new Error("Input elements not found.");if("INPUT"!==n.nodeName)throw new s.P(n,"username","<input>");if("INPUT"!==o.nodeName)throw new s.P(o,"username","<input>");const r=n.value,c=o.value;return new a(r,c)}catch(e){throw console.error(e.toString()),e}}(e,t);if(null!==n)try{const e=await async function(e){const t=new FormData;return t.append("username",e.username),t.append("password",e.password),await fetch(o+"/users/token",{method:"POST",body:t})}(new a(n.username,n.password));if(!e.ok){const t="Server responded with status: "+e.status+".\nReturned message: "+(await e.json()).message;throw new Error(t)}console.log(`Logged in as ${n.username}.`),alert(`Logged in succesfuly as ${n.username}. Returning to main page.`),window.location.replace(o)}catch(e){alert(e)}}("username","password")})}},611(e,t,n){n.d(t,{P:()=>s});class s{#e="";constructor(e,t,n){this.#e=`Invalid type for variable ${t} of type ${typeof e}. Expected ${n}.`,Object.seal(this),Object.preventExtensions(this)}toString(){return this.#e}}}},t={};function n(s){var o=t[s];if(void 0!==o)return o.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var s=n(370);class o{_name;_owner;_value;constructor(e,t,n){this._name=e,this._owner=t,this._value=n,Object.seal(this),Object.preventExtensions(this)}get name(){return this._name}get owner(){return this._owner}get value(){return this._value}}const a="http://127.0.0.1:8000";async function r(e,t){try{const n=document.getElementById(e);null!==n&&(n.innerText=null===t?"Not logged in.":`Logged in as ${t}`)}catch(e){alert(e)}}async function c(e){for(const t of e){const e=document.getElementById(t);e?"none"==e.style.display?e.style.display="block":e.style.display="none":alert("Element not found.")}}function i(e,t){const n=e.insertRow(),s=n.insertCell(),o=n.insertCell();s.innerText=t.name,o.innerText=t.value}async function u(e){try{const t=document.getElementById(e);if(null===t)throw new Error("Table not found.");const n=await fetch(a+"/users/me/items",{method:"GET"}),s=await n.json();if(n.ok){!function(e){let t=e.rows.length;for(;t>1;)e.deleteRow(1),t--}(t);const e=s.items;for(const n of e)i(t,n)}}catch(e){return alert(e),e}}window.onload=async function(){const e=await async function(){const e=new Request(a+"/users/me",{method:"POST",credentials:"include"});try{const t=await fetch(e),n=await t.json();if(t.ok)return new s.s(n.username,""),n;throw new Error("Could not login. Please login manually.")}catch(e){return null}}(),t="current_user_display",n=document.getElementById("delete_account_button"),i=document.getElementById("logout_button"),l=document.getElementById("show_add_item_frame_button"),d=document.getElementById("display_items_frame_button"),m=document.getElementById("hide_display_button"),w=document.getElementById("add_item_button");try{localStorage.removeItem("user")}catch(e){console.log("No username in storage.")}w.addEventListener("click",async()=>{await async function(e,t){try{const n=localStorage.getItem("user");if(!n)throw Error("Could not find username in local storage.");{const s=await async function(e,t,n){const s=document.getElementById(e),a=document.getElementById(t);return new o(s.value,n,a.value)}(e,t,n),r=await fetch(a+"/users/me/addItem",{method:"POST",body:JSON.stringify({name:s.name,owner:s.owner,value:s.value}),headers:{"Content-Type":"application/json"}});if(!r.ok){const e="Server responded with status: "+r.status+".\nReturned message: "+(await r.json()).message;throw new Error(e)}alert("Item created successfully.")}}catch(e){return alert(e),e}}("name_input","value_input"),c(["add_item_frame","show_add_item_frame_button"]),u("items_table")}),l.addEventListener("click",()=>c(["add_item_frame","show_add_item_frame_button"])),d.addEventListener("click",()=>c(["display_items_frame","display_items_frame_button"])),m.addEventListener("click",()=>c(["display_items_frame","display_items_frame_button"])),i.addEventListener("click",async()=>{await async function(){try{(await fetch(a+"/users/me/logout",{method:"POST"})).ok?alert("Logged out succesfuly."):alert("Bruh")}catch(e){alert(e)}}().then(()=>{r(t,null),c(["user_logged_in_frame"])})}),n.addEventListener("click",async()=>{await async function(){try{(await fetch(a+"/users/me/delete",{method:"POST"})).ok&&alert("Acoount deleted succesfuly.")}catch(e){alert(e)}}().then(()=>{r(t,null),c(["user_logged_in_frame"])})}),e&&(r(t,e.username),c(["user_logged_in_frame"]),localStorage.setItem("user",e.username),u("items_table"))}})();
//# sourceMappingURL=home.js.map