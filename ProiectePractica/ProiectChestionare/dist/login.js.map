{"version":3,"file":"login.js","mappings":"sDAEO,MAAMA,EACT,GAAW,GACX,WAAAC,CAAYC,EAAUC,EAAcC,GAChCC,MAAK,EAAW,6BAA6BF,oBAA+B,eAAwBC,KACpGE,OAAOC,KAAKF,MACZC,OAAOE,kBAAkBH,KAC7B,CACA,QAAAI,GACI,OAAOJ,MAAK,CAChB,E,GCVAK,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaE,QAGrB,IAAIC,EAASN,EAAyBE,GAAY,CAGjDG,QAAS,CAAC,GAOX,OAHAE,EAAoBL,GAAUI,EAAQA,EAAOD,QAASJ,GAG/CK,EAAOD,OACf,CCrBAJ,EAAoBO,EAAI,CAACH,EAASI,KACjC,IAAI,IAAIC,KAAOD,EACXR,EAAoBU,EAAEF,EAAYC,KAAST,EAAoBU,EAAEN,EAASK,IAC5Ed,OAAOgB,eAAeP,EAASK,EAAK,CAAEG,YAAY,EAAMC,IAAKL,EAAWC,MCJ3ET,EAAoBU,EAAI,CAACI,EAAKC,IAAUpB,OAAOqB,UAAUC,eAAeC,KAAKJ,EAAKC,G,aCClF,MAAMI,EAAM,wBACL,MAAMC,EACTC,UACAC,UACA,WAAAhC,CAAYiC,EAAUC,GAClB9B,KAAK2B,UAAYE,EACjB7B,KAAK4B,UAAYE,EACjB7B,OAAOC,KAAKF,MACZC,OAAOE,kBAAkBH,KAC7B,CACA,YAAI6B,GAAa,OAAO7B,KAAK2B,SAAW,CACxC,YAAIG,GAAa,OAAO9B,KAAK4B,SAAW,EAoD5CG,OAAOC,OAASC,iBACSC,SAASC,eAAe,gBAChCC,iBAAiB,QAAS,YAvB3CH,eAAqBI,EAAiBC,GAElC,MAAMC,QA/BVN,eAA4BI,EAAiBC,GACzC,IACI,MAAME,EAAgBN,SAASC,eAAeE,GACxCI,EAAgBP,SAASC,eAAeG,GAC9C,GAAsB,OAAlBE,GAA4C,OAAlBC,EAC1B,MAAM,IAAIC,MAAM,6BACpB,GAA+B,UAA3BF,EAAcG,SACd,MAAM,IAAI,IAAgBH,EAAe,WAAY,WACzD,GAA+B,UAA3BC,EAAcE,SACd,MAAM,IAAI,IAAgBF,EAAe,WAAY,WACzD,MAAMZ,EAAWW,EAAcI,MACzBd,EAAWW,EAAcG,MAC/B,OAAO,IAAIlB,EAAUG,EAAUC,EACnC,CACA,MAAOe,GAEH,MADAC,QAAQD,MAAMA,EAAMzC,YACdyC,CACV,CACJ,CAa4BE,CAAaV,EAAiBC,GACtD,GAAkB,OAAdC,EAEJ,IACI,MAAMS,QAbdf,eAA8BM,GAC1B,MAAMU,EAAY,IAAIC,SAGtB,OAFAD,EAAUE,OAAO,WAAYZ,EAAUV,UACvCoB,EAAUE,OAAO,WAAYZ,EAAUT,gBAC1BsB,MAAM3B,EAAM,eAAgB,CAAE4B,OAAQ,OAAQC,KAAML,GACrE,CAQoCM,CAAe,IAAI7B,EAAUa,EAAUV,SAAUU,EAAUT,WACvF,IAAIkB,EAAcQ,GAKb,CACD,MAAMC,EAAW,iCAAmCT,EAAcU,OAAS,+BAAiCV,EAAcW,QAAQC,QAClI,MAAM,IAAIlB,MAAMe,EACpB,CAPIX,QAAQe,IAAI,gBAAgBtB,EAAUV,aACtCiC,MAAM,2BAA2BvB,EAAUV,qCAC3CE,OAAOgC,SAASC,QAAQvC,EAMhC,CACA,MAAOoB,GACHiB,MAAMjB,EACV,CACJ,CAGyDoB,CAAM,WAAY,WAAa,EACxF,C","sources":["webpack://proiectcalumea/./src/UI/utilities.ts","webpack://proiectcalumea/webpack/bootstrap","webpack://proiectcalumea/webpack/runtime/define property getters","webpack://proiectcalumea/webpack/runtime/hasOwnProperty shorthand","webpack://proiectcalumea/./src/UI/login.ts"],"sourcesContent":["// clasa ce implementeaza o eroare de tip pentru o variabila\n// constructorul ia ca parametru variabila, numele acesteia si numele tipului corect\nexport class SimpleTypeError {\n    #message = \"\";\n    constructor(variable, variableName, expectedTypeName) {\n        this.#message = `Invalid type for variable ${variableName} of type ${typeof (variable)}. Expected ${expectedTypeName}.`;\n        Object.seal(this);\n        Object.preventExtensions(this);\n    }\n    toString() {\n        return this.#message;\n    }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import { SimpleTypeError } from \"./utilities\";\nconst url = \"http://127.0.0.1:8000\";\nexport class LoginInfo {\n    _username;\n    _password;\n    constructor(username, password) {\n        this._username = username;\n        this._password = password;\n        Object.seal(this);\n        Object.preventExtensions(this);\n    }\n    get username() { return this._username; }\n    get password() { return this._password; }\n}\nasync function getLoginInfo(usernameInputId, passwordInputId) {\n    try {\n        const usernameInput = document.getElementById(usernameInputId);\n        const passwordInput = document.getElementById(passwordInputId);\n        if (usernameInput === null || passwordInput === null)\n            throw new Error(\"Input elements not found.\");\n        if (usernameInput.nodeName !== \"INPUT\")\n            throw new SimpleTypeError(usernameInput, \"username\", \"<input>\");\n        if (passwordInput.nodeName !== \"INPUT\")\n            throw new SimpleTypeError(passwordInput, \"username\", \"<input>\");\n        const username = usernameInput.value;\n        const password = passwordInput.value;\n        return new LoginInfo(username, password);\n    }\n    catch (error) {\n        console.error(error.toString());\n        throw error;\n    }\n}\n// functie ce trimite credentialele la server\n// daca credentialele sunt corecte, raspunsul are atasat un htmlonly cookie cu valoarea jetonului de autentificare\n// jetonul este salvat automat in browser\nasync function getAccessToken(loginInfo) {\n    const loginForm = new FormData();\n    loginForm.append(\"username\", loginInfo.username);\n    loginForm.append(\"password\", loginInfo.password);\n    return await fetch(url + \"/users/token\", { method: \"POST\", body: loginForm });\n}\n// functie pt login in urma introducerii credentialelor\nasync function login(usernameInputId, passwordInputId) {\n    // initial citim datele introduse in formular\n    const loginInfo = await getLoginInfo(usernameInputId, passwordInputId);\n    if (loginInfo === null)\n        return undefined;\n    try {\n        const tokenResponse = await getAccessToken(new LoginInfo(loginInfo.username, loginInfo.password));\n        if (tokenResponse.ok) {\n            console.log(`Logged in as ${loginInfo.username}.`);\n            alert(`Logged in succesfuly as ${loginInfo.username}. Returning to main page.`);\n            window.location.replace(url);\n        }\n        else {\n            const errorMsg = \"Server responded with status: \" + tokenResponse.status + \".\\nReturned message: \" + (await tokenResponse.json()).message;\n            throw new Error(errorMsg);\n        }\n    }\n    catch (error) {\n        alert(error);\n    }\n}\nwindow.onload = async function () {\n    const login_button = document.getElementById(\"login_button\");\n    login_button.addEventListener(\"click\", function () { login(\"username\", \"password\"); });\n};\n"],"names":["SimpleTypeError","constructor","variable","variableName","expectedTypeName","this","Object","seal","preventExtensions","toString","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","d","definition","key","o","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","url","LoginInfo","_username","_password","username","password","window","onload","async","document","getElementById","addEventListener","usernameInputId","passwordInputId","loginInfo","usernameInput","passwordInput","Error","nodeName","value","error","console","getLoginInfo","tokenResponse","loginForm","FormData","append","fetch","method","body","getAccessToken","ok","errorMsg","status","json","message","log","alert","location","replace","login"],"ignoreList":[],"sourceRoot":""}