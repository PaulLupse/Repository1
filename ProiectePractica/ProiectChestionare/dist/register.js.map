{"version":3,"file":"register.js","mappings":"kDACA,MAAMA,EAAM,wBACL,MAAMC,EACTC,UACAC,UACA,WAAAC,CAAYC,EAAUC,GAClBC,KAAKL,UAAYG,EACjBE,KAAKJ,UAAYG,EACjBE,OAAOC,KAAKF,MACZC,OAAOE,kBAAkBH,KAC7B,CACA,YAAIF,GAAa,OAAOE,KAAKL,SAAW,CACxC,YAAII,GAAa,OAAOC,KAAKJ,SAAW,EAoD5CQ,OAAOC,OAASC,iBACSC,SAASC,eAAe,gBAChCC,iBAAiB,QAAS,YAvB3CH,eAAqBI,EAAiBC,GAElC,MAAMC,QA/BVN,eAA4BI,EAAiBC,GACzC,IACI,MAAME,EAAgBN,SAASC,eAAeE,GACxCI,EAAgBP,SAASC,eAAeG,GAC9C,GAAsB,OAAlBE,GAA4C,OAAlBC,EAC1B,MAAM,IAAIC,MAAM,6BACpB,GAA+B,UAA3BF,EAAcG,SACd,MAAM,IAAI,IAAgBH,EAAe,WAAY,WACzD,GAA+B,UAA3BC,EAAcE,SACd,MAAM,IAAI,IAAgBF,EAAe,WAAY,WACzD,MAAMhB,EAAWe,EAAcI,MACzBlB,EAAWe,EAAcG,MAC/B,OAAO,IAAIvB,EAAUI,EAAUC,EACnC,CACA,MAAOmB,GAEH,MADAC,QAAQD,MAAMA,EAAME,YACdF,CACV,CACJ,CAa4BG,CAAaX,EAAiBC,GACtD,GAAkB,OAAdC,EAEJ,IACI,MAAMU,QAbdhB,eAA8BM,GAC1B,MAAMW,EAAY,IAAIC,SAGtB,OAFAD,EAAUE,OAAO,WAAYb,EAAUd,UACvCyB,EAAUE,OAAO,WAAYb,EAAUb,gBAC1B2B,MAAMjC,EAAM,eAAgB,CAAEkC,OAAQ,OAAQC,KAAML,GACrE,CAQoCM,CAAe,IAAInC,EAAUkB,EAAUd,SAAUc,EAAUb,WACvF,IAAIuB,EAAcQ,GAKb,CACD,MAAMC,EAAW,iCAAmCT,EAAcU,OAAS,+BAAiCV,EAAcW,QAAQC,QAClI,MAAM,IAAInB,MAAMgB,EACpB,CAPIZ,QAAQgB,IAAI,gBAAgBvB,EAAUd,aACtCsC,MAAM,2BAA2BxB,EAAUd,qCAC3CM,OAAOiC,SAASC,QAAQ7C,EAMhC,CACA,MAAOyB,GACHkB,MAAMlB,EACV,CACJ,CAGyDqB,CAAM,WAAY,WAAa,EACxF,C,8BCjEO,MAAMC,EACT,GAAW,GACX,WAAA3C,CAAY4C,EAAUC,EAAcC,GAChC3C,MAAK,EAAW,6BAA6B0C,oBAA+B,eAAwBC,KACpG1C,OAAOC,KAAKF,MACZC,OAAOE,kBAAkBH,KAC7B,CACA,QAAAoB,GACI,OAAOpB,MAAK,CAChB,E,GCVA4C,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaE,QAGrB,IAAIC,EAASN,EAAyBE,GAAY,CAGjDG,QAAS,CAAC,GAOX,OAHAE,EAAoBL,GAAUI,EAAQA,EAAOD,QAASJ,GAG/CK,EAAOD,OACf,CCrBAJ,EAAoBO,EAAI,CAACH,EAASI,KACjC,IAAI,IAAIC,KAAOD,EACXR,EAAoBU,EAAEF,EAAYC,KAAST,EAAoBU,EAAEN,EAASK,IAC5ErD,OAAOuD,eAAeP,EAASK,EAAK,CAAEG,YAAY,EAAMC,IAAKL,EAAWC,MCJ3ET,EAAoBU,EAAI,CAACI,EAAKC,IAAU3D,OAAO4D,UAAUC,eAAeC,KAAKJ,EAAKC,G,oBCGlF,MAAMI,EACF,GACA,GACA,GACA,WAAAnE,CAAYC,EAAUC,EAAUkE,GAC5BjE,MAAK,EAAaF,EAClBE,MAAK,EAAaD,EAClBC,MAAK,EAAUiE,EACfhE,OAAOC,KAAKF,MACZC,OAAOE,kBAAkBH,KAC7B,CACA,YAAIF,GAAa,OAAOE,MAAK,CAAY,CACzC,YAAID,GAAa,OAAOC,MAAK,CAAY,CACzC,SAAIiE,GAAU,OAAOjE,MAAK,CAAS,EA8DvCI,OAAOC,OAAS,WACWE,SAASC,eAAe,mBAChCC,iBAAiB,QAAS,YAjC7CH,eAAwBI,EAAiBC,EAAiBuD,GACtD,IACI,MAAMC,QA/Bd7D,eAA+BI,EAAiBC,EAAiBuD,GAC7D,GAAiC,iBAAtB,EACP,MAAM,IAAI,IAAgBxD,EAAiB,kBAAmB,UAClE,GAAiC,iBAAtB,EACP,MAAM,IAAI,IAAgBA,EAAiB,kBAAmB,UAClE,GAA8B,iBAAnB,EACP,MAAM,IAAI,IAAgBA,EAAiB,kBAAmB,UAClE,OAAO,IAAI0D,QAAQ,SAAUC,EAASC,GAClC,IACI,MAAMzD,EAAgBN,SAASC,eAAeE,GACxCI,EAAgBP,SAASC,eAAeG,GACxC4D,EAAahE,SAASC,eAAe0D,GAC3C,GAA+B,UAA3BrD,EAAcG,SACd,MAAM,IAAI,IAAgBH,EAAe,gBAAiB,WAC9D,GAA+B,UAA3BC,EAAcE,SACd,MAAM,IAAI,IAAgBF,EAAe,gBAAiB,WAC9D,GAA4B,UAAxByD,EAAWvD,SACX,MAAM,IAAI,IAAgBuD,EAAY,aAAc,WACxD,MAAMzE,EAAWe,EAAcI,MACzBlB,EAAWe,EAAcG,MACzBgD,EAAQM,EAAWtD,MACzBoD,EAAQ,IAAIL,EAAclE,EAAUC,EAAUkE,GAClD,CACA,MAAO/C,GACHC,QAAQgB,IAAIjB,EAAME,YAClBkD,EAAOpD,EACX,CACJ,EACJ,CAGoCsD,CAAgB9D,EAAiBC,EAAiBuD,GACxEO,EAAgB,IAAIC,QAAQ,CAC9B,OAAU,mBACV,eAAgB,qBAEdC,EAAU,IAAIC,QAAQnF,uCAAyB,CACjDkC,OAAQ,MACRkD,QAASJ,EACT7C,KAAMkD,KAAKC,UAAU,CACjBjF,SAAUqE,EAAcrE,SACxBC,SAAUoE,EAAcpE,SACxBkE,MAAOE,EAAcF,UAGvBe,QAAiBtD,MAAMiD,GAC7B,IAAIK,EAASlD,GAIR,CACD,MAAMmD,QAAaD,EAAS/C,OAC5B,MAAM,IAAIlB,MAAM,qCAAuCiE,EAAShD,OAC1D,wBAA0BiD,EAAK/C,QACzC,CARiB,CACb,MAAM+C,QAAaD,EAAS/C,OAC5BG,MAAM6C,EAAK/C,QACf,CAMJ,CACA,MAAOhB,GACHkB,MAAMlB,EAAME,WAChB,CACJ,CAG2D8D,CAAS,iBAAkB,iBAAkB,cAAgB,EACxH,C","sources":["webpack://proiectcalumea/./src/UI/login.ts","webpack://proiectcalumea/./src/UI/utilities.ts","webpack://proiectcalumea/webpack/bootstrap","webpack://proiectcalumea/webpack/runtime/define property getters","webpack://proiectcalumea/webpack/runtime/hasOwnProperty shorthand","webpack://proiectcalumea/./src/UI/register.ts"],"sourcesContent":["import { SimpleTypeError } from \"./utilities\";\nconst url = \"http://127.0.0.1:8000\";\nexport class LoginInfo {\n    _username;\n    _password;\n    constructor(username, password) {\n        this._username = username;\n        this._password = password;\n        Object.seal(this);\n        Object.preventExtensions(this);\n    }\n    get username() { return this._username; }\n    get password() { return this._password; }\n}\nasync function getLoginInfo(usernameInputId, passwordInputId) {\n    try {\n        const usernameInput = document.getElementById(usernameInputId);\n        const passwordInput = document.getElementById(passwordInputId);\n        if (usernameInput === null || passwordInput === null)\n            throw new Error(\"Input elements not found.\");\n        if (usernameInput.nodeName !== \"INPUT\")\n            throw new SimpleTypeError(usernameInput, \"username\", \"<input>\");\n        if (passwordInput.nodeName !== \"INPUT\")\n            throw new SimpleTypeError(passwordInput, \"username\", \"<input>\");\n        const username = usernameInput.value;\n        const password = passwordInput.value;\n        return new LoginInfo(username, password);\n    }\n    catch (error) {\n        console.error(error.toString());\n        throw error;\n    }\n}\n// functie ce trimite credentialele la server\n// daca credentialele sunt corecte, raspunsul are atasat un htmlonly cookie cu valoarea jetonului de autentificare\n// jetonul este salvat automat in browser\nasync function getAccessToken(loginInfo) {\n    const loginForm = new FormData();\n    loginForm.append(\"username\", loginInfo.username);\n    loginForm.append(\"password\", loginInfo.password);\n    return await fetch(url + \"/users/token\", { method: \"POST\", body: loginForm });\n}\n// functie pt login in urma introducerii credentialelor\nasync function login(usernameInputId, passwordInputId) {\n    // initial citim datele introduse in formular\n    const loginInfo = await getLoginInfo(usernameInputId, passwordInputId);\n    if (loginInfo === null)\n        return undefined;\n    try {\n        const tokenResponse = await getAccessToken(new LoginInfo(loginInfo.username, loginInfo.password));\n        if (tokenResponse.ok) {\n            console.log(`Logged in as ${loginInfo.username}.`);\n            alert(`Logged in succesfuly as ${loginInfo.username}. Returning to main page.`);\n            window.location.replace(url);\n        }\n        else {\n            const errorMsg = \"Server responded with status: \" + tokenResponse.status + \".\\nReturned message: \" + (await tokenResponse.json()).message;\n            throw new Error(errorMsg);\n        }\n    }\n    catch (error) {\n        alert(error);\n    }\n}\nwindow.onload = async function () {\n    const login_button = document.getElementById(\"login_button\");\n    login_button.addEventListener(\"click\", function () { login(\"username\", \"password\"); });\n};\n","// clasa ce implementeaza o eroare de tip pentru o variabila\n// constructorul ia ca parametru variabila, numele acesteia si numele tipului corect\nexport class SimpleTypeError {\n    #message = \"\";\n    constructor(variable, variableName, expectedTypeName) {\n        this.#message = `Invalid type for variable ${variableName} of type ${typeof (variable)}. Expected ${expectedTypeName}.`;\n        Object.seal(this);\n        Object.preventExtensions(this);\n    }\n    toString() {\n        return this.#message;\n    }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import { LoginInfo } from \"./login\";\nimport { SimpleTypeError } from \"./utilities\";\nconst url = \"http://127.0.0.1:8000\";\nclass RegisterInput {\n    #_username;\n    #_password;\n    #_email;\n    constructor(username, password, email) {\n        this.#_username = username;\n        this.#_password = password;\n        this.#_email = email;\n        Object.seal(this);\n        Object.preventExtensions(this);\n    }\n    get username() { return this.#_username; }\n    get password() { return this.#_password; }\n    get email() { return this.#_email; }\n}\nasync function getRegisterData(usernameInputId, passwordInputId, emailInputId) {\n    if (typeof (usernameInputId) !== \"string\")\n        throw new SimpleTypeError(usernameInputId, \"usernameInputId\", \"string\");\n    if (typeof (passwordInputId) !== \"string\")\n        throw new SimpleTypeError(usernameInputId, \"usernameInputId\", \"string\");\n    if (typeof (emailInputId) !== \"string\")\n        throw new SimpleTypeError(usernameInputId, \"usernameInputId\", \"string\");\n    return new Promise(function (resolve, reject) {\n        try {\n            const usernameInput = document.getElementById(usernameInputId);\n            const passwordInput = document.getElementById(passwordInputId);\n            const emailInput = document.getElementById(emailInputId);\n            if (usernameInput.nodeName !== \"INPUT\")\n                throw new SimpleTypeError(usernameInput, \"usernameInput\", \"<input>\");\n            if (passwordInput.nodeName !== \"INPUT\")\n                throw new SimpleTypeError(passwordInput, \"passwordInput\", \"<input>\");\n            if (emailInput.nodeName !== \"INPUT\")\n                throw new SimpleTypeError(emailInput, \"emailInput\", \"<input>\");\n            const username = usernameInput.value;\n            const password = passwordInput.value;\n            const email = emailInput.value;\n            resolve(new RegisterInput(username, password, email));\n        }\n        catch (error) {\n            console.log(error.toString());\n            reject(error);\n        }\n    });\n}\nasync function register(usernameInputId, passwordInputId, emailInputId) {\n    try {\n        const registerInput = await getRegisterData(usernameInputId, passwordInputId, emailInputId);\n        const requestHeader = new Headers({\n            'Accept': \"application/json\",\n            'Content-Type': \"application/json\"\n        });\n        const request = new Request(url + \"/users/register\", {\n            method: \"PUT\",\n            headers: requestHeader,\n            body: JSON.stringify({\n                username: registerInput.username,\n                password: registerInput.password,\n                email: registerInput.email\n            })\n        });\n        const response = await fetch(request);\n        if (response.ok) {\n            const data = await response.json();\n            alert(data.message);\n        }\n        else {\n            const data = await response.json();\n            throw new Error(\"Server has responded with status: \" + response.status\n                + \".\\nReturned message: \" + data.message);\n        }\n    }\n    catch (error) {\n        alert(error.toString());\n    }\n}\nwindow.onload = function () {\n    const registerButton = document.getElementById(\"register_button\");\n    registerButton.addEventListener(\"click\", function () { register(\"username_input\", \"password_input\", \"email_input\"); });\n};\n"],"names":["url","LoginInfo","_username","_password","constructor","username","password","this","Object","seal","preventExtensions","window","onload","async","document","getElementById","addEventListener","usernameInputId","passwordInputId","loginInfo","usernameInput","passwordInput","Error","nodeName","value","error","console","toString","getLoginInfo","tokenResponse","loginForm","FormData","append","fetch","method","body","getAccessToken","ok","errorMsg","status","json","message","log","alert","location","replace","login","SimpleTypeError","variable","variableName","expectedTypeName","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","d","definition","key","o","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","RegisterInput","email","emailInputId","registerInput","Promise","resolve","reject","emailInput","getRegisterData","requestHeader","Headers","request","Request","headers","JSON","stringify","response","data","register"],"ignoreList":[],"sourceRoot":""}